DROP TABLE REGIONS CASCADE CONSTRAINTS;
DROP TABLE LOCATIONS CASCADE CONSTRAINTS;
DROP TABLE JOBS CASCADE CONSTRAINTS;
DROP TABLE JOB_HISTORY CASCADE CONSTRAINTS;
DROP TABLE EMPLOYEES CASCADE CONSTRAINTS;
DROP TABLE DEPARTMENTS CASCADE CONSTRAINTS;
DROP TABLE COUNTRIES CASCADE CONSTRAINTS;

CREATE TABLE REGIONS AS SELECT * FROM hr.REGIONS
CREATE TABLE LOCATIONS AS SELECT * FROM hr.LOCATIONS
CREATE TABLE JOB_HISTORY AS SELECT * FROM hr.JOB_HISTORY
CREATE TABLE JOBS AS SELECT * FROM hr.JOBS
CREATE TABLE EMPLOYEES AS SELECT * FROM hr.EMPLOYEES
CREATE TABLE DEPARTMENTS AS SELECT * FROM hr.DEPARTMENTS
CREATE TABLE COUNTRIES AS SELECT * FROM hr.COUNTRIES

ALTER TABLE REGIONS ADD PRIMARY KEY (region_id);
ALTER TABLE COUNTRIES ADD PRIMARY KEY (country_id);
ALTER TABLE COUNTRIES ADD FOREIGN KEY (region_id) REFERENCES REGIONS(region_id);
ALTER TABLE LOCATIONS ADD PRIMARY KEY (location_id);
ALTER TABLE LOCATIONS ADD FOREIGN KEY (country_id) REFERENCES COUNTRIES(country_id);
ALTER TABLE JOBS ADD PRIMARY KEY (job_id);
ALTER TABLE DEPARTMENTS ADD PRIMARY KEY (department_id);
ALTER TABLE EMPLOYEES ADD PRIMARY KEY (employee_id);
ALTER TABLE JOB_HISTORY ADD PRIMARY KEY (start_date);
ALTER TABLE JOB_HISTORY ADD FOREIGN KEY (job_id) REFERENCES JOBS(job_id);
ALTER TABLE JOB_HISTORY ADD FOREIGN KEY (department_id) REFERENCES DEPARTMENTS(department_id);
ALTER TABLE DEPARTMENTS ADD FOREIGN KEY (manager_id) REFERENCES EMPLOYEES(employee_id);
ALTER TABLE DEPARTMENTS ADD FOREIGN KEY (location_id) REFERENCES LOCATIONS(location_id);
ALTER TABLE EMPLOYEES ADD FOREIGN KEY (job_id) REFERENCES JOBS(job_id);
ALTER TABLE EMPLOYEES ADD FOREIGN KEY (manager_id) REFERENCES EMPLOYEES(employee_id);
ALTER TABLE EMPLOYEES ADD FOREIGN KEY (department_id) REFERENCES DEPARTMENTS(department_id);

-----------------------------------------------------------------------------------------------------------------
~~~1~~
SELECT CONCAT(CONCAT(last_name, ' '), salary) as wynagrodzenie 
from EMPLOYEES 
WHERE department_id in (20, 50) 
AND 
salary BETWEEN 2000 AND 7000;

~~2~~
SELECT hire_date, last_name, &x as user_column
FROM EMPLOYEES 
WHERE manager_id IS NOT NULL 
AND 
EXTRACT(YEAR FROM TO_DATE(hire_date, 'DD-MM-RR')) = 2005 
ORDER BY user_column;

~~3~~
SELECT CONCAT(CONCAT(first_name, ' '),last_name) as Person, salary, phone_number
FROM EMPLOYEES
WHERE last_name LIKE '__e%' 
AND 
first_name LIKE '%' || '&imie' || '%'
ORDER BY 1 desc, 2 asc;

~~4~~
SELECT first_name, last_name, ROUND(MONTHS_BETWEEN(sysdate,hire_date),0) summed_months,
CASE
    WHEN summed_months < 150 THEN salary* 0.1
    WHEN summed_months BETWEEN 150 AND 200 THEN salary*0.3
    WHEN summed_months > 200 THEN salary*0.3
END AS wysokosc_dodatku
FROM EMPLOYEES;

~~5~~
SELECT DEPARTMENTS.department_name,
SUM(EMPLOYEES.salary) as Salary_summary,
ROUND(avg(EMPLOYEES.salary),0) as Average_salary
FROM EMPLOYEES, DEPARTMENTS
GROUP BY EMPLOYEES.department_id, DEPARTMENTS.department_name
HAVING MIN(EMPLOYEES.salary) > 5000;

~~6~~
SELECT EMPLOYEES.last_name, EMPLOYEES.department_id, DEPARTMENTS.department_name,EMPLOYEES.job_id
FROM EMPLOYEES, DEPARTMENTS, LOCATIONS
WHERE EMPLOYEES.department_id = DEPARTMENTS.department_id
AND DEPARTMENTS.location_id = LOCATIONS.location_id
AND city='Toronto'

~~7~~
SELECT first_name,last_name, department_id
FROM EMPLOYEES
WHERE department_id IN
(
    SELECT DISTINCT department_id 
    FROM EMPLOYEES
    WHERE first_name = 'Jennifer'
);

~~8~~
SELECT department_name
FROM DEPARTMENTS
WHERE department_id NOT IN
(
    SELECT department_id
    FROM EMPLOYEES
    WHERE department_id IS NOT NULL
)

~~9~~
CREATE TABLE JOB_GRADES AS SELECT * FROM hr.JOB_GRADES

~~10~~
SELECT EMPLOYEES.first_name, EMPLOYEES.last_name, EMPLOYEES.job_id, DEPARTMENTS.department_name, EMPLOYEES.salary, JOB_GRADES.grade
FROM EMPLOYEES, DEPARTMENTS,JOB_GRADES
WHERE EMPLOYEES.department_id = DEPARTMENTS.department_id 
AND 
EMPLOYEES.salary BETWEEN JOB_GRADES.MIN_SALARY AND JOB_GRADES.MAX_SALARY;

~~11~~
SELECT first_name,last_name, salary
FROM EMPLOYEES
WHERE salary < (SELECT AVG(salary) FROM EMPLOYEES)
ORDER BY 3 DESC;

~~12~~
SELECT employee_id, first_name, last_name
FROM EMPLOYEES
WHERE department_id IN
(
    SELECT DISTINCT department_id 
    FROM EMPLOYEES
    WHERE last_name LIKE '%u%'
)